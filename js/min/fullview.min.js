"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(o,r,l,a){var s="fullView";function i(t,i){this._defaults=o.fn.fullView.defaults,this.options=o.extend({},this._defaults,i),this.mainView=o(t),this.views=o(t).children(),this._name=s,this.currentView=0,this.previousView=0,this.isScrolling=!1,this.isProgress=!1,this.offsets=[],this.$dotsElement=null,this.$navbar=null,this.$anchors={},this.lastY=null,this.lastX=null,this.init()}o.extend(i.prototype,{init:function(){this.buildCache(),this.utilites(),this.settingUp(),this.bindEvents()},destroy:function(){this.unbindEvents(),this.$views.removeData()},buildCache:function(){this.$window=o(r),this.$document=o(l),this.$htmlBody=o("html, body"),this.$views=o(this.views),this.options.navbar!==a&&"string"==typeof this.options.navbar&&o(this.options.navbar).length&&(this.$navbar=o(this.options.navbar))},utilites:function(){this.createDots=function(){var t=o("#fv-dots");t.length&&t.remove();var s=o("<div>").attr("id","fv-dots").append("<ul>");if(!0===this.options.dotsTooltips){var e=this;this.$views.each(function(t){var i=e.$views.eq(t).attr("data-tooltip")?e.$views.eq(t).attr("data-tooltip"):null;i?s.find("ul").append('<li class="fv-tooltip"><a data-scroll="'+t+'" href="#" class=""><span></span></a><span class="fv-tooltiptext">'+i+"</span></li>"):s.find("ul").append('<li class="fv-tooltip"><a data-scroll="'+t+'" href="#" class=""><span></span></a></li>')})}else this.$views.each(function(t){s.find("ul").append('<li><a data-scroll="'+t+'" href="#" class=""><span></span></a></li>')});return"right"!==this.options.dotsPosition&&(s.css({left:"4%"}),s.find(".fv-tooltip .fv-tooltiptext").css({right:"unset",left:"105%"}),s.find(".fv-tooltip").addClass("fv-tooltip-left")),o("body").append(s),s.find("a")},this.changeActiveStatus=function(t){this.$views.removeClass("active").eq(t).addClass("active"),this.options.dots&&this.$dotsElement.removeClass("active").eq(t).addClass("active"),this.$anchors.length&&this.$anchors.removeClass("active").filter('[data-scroll="'+t+'"]').addClass("active")},this.scrollTo=function(t,i){var s=this;t=parseInt(t),this.offsets[t]!==a&&"number"==typeof t?(this.isProgress=!0,this.previousView=this.currentView===t?this.previousView:this.currentView,this.currentView=t,i===a&&(this.previousView>this.currentView?i="up":this.previousView<this.currentView&&(i="down")),this.callback("onScrollStart",{destination:t,current:this.previousView,direction:i}),this.$htmlBody.stop(!0).animate({scrollTop:this.offsets[t].offset},{easing:o.easing[this.options.easing]?this.options.easing:"linear",duration:this.options.speed}).promise().then(function(){s.changeActiveStatus(t),!0===s.isScrolling&&setTimeout(function(){s.isScrolling=!1},s.options.speed+320),this.isProgress=!1,s.callback("onScrollEnd",{direction:i})})):console.warn("The View You Want To Scroll To Does not Exist!")},this.scrollByWheel=function(t){o(":animated").length||this.isScrolling||(this.isScrolling=!0,0<t.originalEvent.wheelDelta||t.originalEvent.detail<0?this.scrollUp():this.scrollDown())},this.scrollDown=function(){var t="down";return this.currentView<this.$views.length-1?(this.previousView=this.currentView,this.currentView++,this.scrollTo(this.currentView,t)):this.currentView===this.$views.length-1&&(this.isScrolling=!1,this.options.backToTop&&(this.isScrolling=!0,this.previousView=this.currentView,this.currentView=0,this.scrollTo(this.currentView,t))),this},this.scrollUp=function(){return 0<this.currentView?(this.previousView=this.currentView,this.currentView--,this.scrollTo(this.currentView,"up")):0===this.currentView&&(this.isScrolling=!1),this}},settingUp:function(){var t=this.$window.height();if(this.$views.css({height:t}),this.currentView=0,this.isScrolling=!1,l.body.scrollTop=0,l.documentElement.scrollTop=0,"number"!=typeof this.options.speed?(this.options.speed=500,console.warn("Speed Should be of Type Number")):this.options.speed<=300&&(this.options.speed=300,console.warn("Min Speed is 350 miliseconds")),this.offsets.splice(0,this.offsets.length),this.$views.each(function(t){var i=this.$views.eq(t).attr("id"),s=this.$views.eq(t).offset().top;this.offsets.push({position:t,anchor:i,offset:s})}.bind(this)),null!==this.$navbar){var s=this.$navbar,i="a[href='"+this.offsets.filter(function(t){if(t.anchor===a)return!1;var i=s.find('a[href="#'+t.anchor+'"]');return i.length&&i.attr("data-scroll",t.position),!0}).map(function(t){return"#"+t.anchor}).join("'], a[href='")+"']";this.$anchors=this.$navbar.find(i)}this.options.dots&&(this.$dotsElement=this.createDots());var e=this.$views.filter('[class="active"]');if(e.length){var n=e.eq(0).offset().top,o=this.offsets.filter(function(t){return t.offset===n});this.currentView=o[0].position,this.previousView=this.currentView,l.body.scrollTop=n,l.documentElement.scrollTop=n}this.options.dots&&(this.$dotsElement=this.createDots()),this.changeActiveStatus(this.currentView)},bindEvents:function(){var n=this;n.$window.on("resize."+n._name,n.settingUp.bind(n)),null!==n.$dotsElement&&n.$dotsElement.on("click."+n._name,function(t){t.preventDefault(),o(":animated").length||(n.previousView=n.currentView,n.currentView=parseInt(o(this).attr("data-scroll")),n.scrollTo(n.currentView))}),n.$anchors!==a&&0<n.$anchors.length&&n.$anchors.on("click."+n._name,function(t){t.preventDefault(),o(":animated").length||(n.previousView=n.currentView,n.currentView=parseInt(o(this).attr("data-scroll")),n.scrollTo(n.currentView))}),n.options.mouseScrolling&&n.$window.on("DOMMouseScroll mousewheel."+n._name,function(t){var i=t||r.event;"INPUT"!=(i.target||i.srcElement).tagName.toUpperCase()&&n.scrollByWheel(i)}),n.options.keyboardScrolling&&n.$document.on("keydown."+n._name,function(t){var i=t||r.event;if("INPUT"!=(i.target||i.srcElement).tagName.toUpperCase()&&(!o(":animated").length&&!n.isScrolling))switch(i.keyCode?i.keyCode:i.which){case 40:n.scrollDown();break;case 38:case 33:n.scrollUp();break;case 34:n.scrollDown()}}),n.$views.on("touchstart."+n._name,function(t){n.lastY=t.originalEvent.touches[0].clientY,n.lastX=t.originalEvent.touches[0].clientX}),n.options.touchScrolling&&n.$views.on("touchend."+n._name,function(t){var i=t||r.event;if("INPUT"!=(i.target||i.srcElement).tagName.toUpperCase()){var s=i.originalEvent.changedTouches[0].clientY,e=i.originalEvent.changedTouches[0].clientX;e<n.lastX||n.lastX,n.lastY>s+25?n.scrollDown():n.lastY<s-25&&n.scrollUp()}})},unbindEvents:function(){this.$window.off("."+this._name),this.$document.off("."+this._name),this.$views.off("."+this._name)},callback:function(t,i){var s=this.options.onScrollStart,e=this.options.onScrollEnd;"function"==typeof e&&"onScrollEnd"===t&&e(this.$views.eq(this.currentView),this.$views.eq(this.previousView),i.direction),"function"==typeof s&&"onScrollStart"===t&&s(this.$views.eq(i.current),this.$views.eq(i.destination),i.direction)}}),o.fn.fullView=function(t){return t===a||"object"===_typeof(t)?this.each(function(){o.data(this,s)||o.data(this,s,new i(this,t))}):this},o.fn.fullView.defaults={navbar:a,dots:!0,dotsPosition:"right",dotsTooltips:!1,easing:"linear",backToTop:!1,speed:500,keyboardScrolling:!0,mouseScrolling:!0,touchScrolling:!0,onScrollEnd:null,onScrollStart:null}}(jQuery,window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZ1bGx2aWV3LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJkb2N1bWVudCIsInVuZGVmaW5lZCIsImZ1bGxWaWV3IiwiRnVsbFZpZXciLCJ2aWV3cyIsIm9wdGlvbnMiLCJ0aGlzIiwiX2RlZmF1bHRzIiwiZm4iLCJkZWZhdWx0cyIsImV4dGVuZCIsIm1haW5WaWV3IiwiY2hpbGRyZW4iLCJfbmFtZSIsImN1cnJlbnRWaWV3IiwicHJldmlvdXNWaWV3IiwiaXNTY3JvbGxpbmciLCJpc1Byb2dyZXNzIiwib2Zmc2V0cyIsIiRkb3RzRWxlbWVudCIsIiRuYXZiYXIiLCIkYW5jaG9ycyIsImxhc3RZIiwibGFzdFgiLCJpbml0IiwicHJvdG90eXBlIiwiYnVpbGRDYWNoZSIsInV0aWxpdGVzIiwic2V0dGluZ1VwIiwiYmluZEV2ZW50cyIsImRlc3Ryb3kiLCJ1bmJpbmRFdmVudHMiLCIkdmlld3MiLCJyZW1vdmVEYXRhIiwiJHdpbmRvdyIsIiRkb2N1bWVudCIsIiRodG1sQm9keSIsIm5hdmJhciIsImxlbmd0aCIsImNyZWF0ZURvdHMiLCIkZG90cyIsInJlbW92ZSIsImRpdiIsImF0dHIiLCJhcHBlbmQiLCJkb3RzVG9vbHRpcHMiLCJwbHVnaW4iLCJlYWNoIiwiaSIsInRvb2x0aXBUaXRsZSIsImVxIiwiZmluZCIsImRvdHNQb3NpdGlvbiIsImNzcyIsImxlZnQiLCJyaWdodCIsImFkZENsYXNzIiwiY2hhbmdlQWN0aXZlU3RhdHVzIiwiJHZpZXciLCJyZW1vdmVDbGFzcyIsImRvdHMiLCJmaWx0ZXIiLCJzY3JvbGxUbyIsImRpciIsInBhcnNlSW50IiwiY2FsbGJhY2siLCJkZXN0aW5hdGlvbiIsImN1cnJlbnQiLCJkaXJlY3Rpb24iLCJzdG9wIiwiYW5pbWF0ZSIsInNjcm9sbFRvcCIsIm9mZnNldCIsImVhc2luZyIsImR1cmF0aW9uIiwic3BlZWQiLCJwcm9taXNlIiwidGhlbiIsInNldFRpbWVvdXQiLCJjb25zb2xlIiwid2FybiIsInNjcm9sbEJ5V2hlZWwiLCJldmVudCIsIm9yaWdpbmFsRXZlbnQiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwic2Nyb2xsVXAiLCJzY3JvbGxEb3duIiwiYmFja1RvVG9wIiwidmgiLCJoZWlnaHQiLCJib2R5IiwiZG9jdW1lbnRFbGVtZW50Iiwic3BsaWNlIiwiYW5jaG9yIiwidmlld09mZnNldCIsInRvcCIsInB1c2giLCJwb3NpdGlvbiIsImJpbmQiLCIkbWVudSIsInF1ZXJ5U3RyaW5nIiwib2JqIiwiJG1lbnVpdGVtIiwibWFwIiwiam9pbiIsIiRhY3R2aWV3IiwiYWN0aXZlRGF0YSIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwibW91c2VTY3JvbGxpbmciLCJ0YXJnZXQiLCJzcmNFbGVtZW50IiwidGFnTmFtZSIsInRvVXBwZXJDYXNlIiwia2V5Ym9hcmRTY3JvbGxpbmciLCJrZXlDb2RlIiwid2hpY2giLCJ0b3VjaGVzIiwiY2xpZW50WSIsImNsaWVudFgiLCJ0b3VjaFNjcm9sbGluZyIsImN1cnJlbnRZIiwiY2hhbmdlZFRvdWNoZXMiLCJjdXJyZW50WCIsIm9mZiIsImV2ZW50TmFtZSIsImFkZHRpb25hbCIsIm9uU2Nyb2xsU3RhcnQiLCJvblNjcm9sbEVuZCIsIl90eXBlb2YiLCJkYXRhIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiK1BBV0UsU0FBV0EsRUFBR0MsRUFBUUMsRUFBVUMsR0FFOUIsSUFBSUMsRUFBVyxXQUdmLFNBQVNDLEVBQVNDLEVBQU9DLEdBRXJCQyxLQUFLQyxVQUFZVCxFQUFFVSxHQUFHTixTQUFTTyxTQUUvQkgsS0FBS0QsUUFBVVAsRUFBRVksT0FBTyxHQUFJSixLQUFLQyxVQUFXRixHQUM1Q0MsS0FBS0ssU0FBV2IsRUFBRU0sR0FDbEJFLEtBQUtGLE1BQVFOLEVBQUVNLEdBQU9RLFdBRXRCTixLQUFLTyxNQUFRWCxFQUViSSxLQUFLUSxZQUFjLEVBQ25CUixLQUFLUyxhQUFlLEVBQ3BCVCxLQUFLVSxhQUFjLEVBQ25CVixLQUFLVyxZQUFhLEVBQ2xCWCxLQUFLWSxRQUFVLEdB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R1hSLEVBQUVVLEdBQUdOLFNBQVNPLFNBQVcsQ0FFckI0QixPQUFRcEMsRUFDUjJELE1BQU0sRUFDTlIsYUFBYyxRQUNkUCxjQUFjLEVBR2Q0QixPQUFRLFNBQ1JlLFdBQVcsRUFDWGIsTUFBTyxJQUdQeUMsbUJBQW1CLEVBQ25CTCxnQkFBZ0IsRUFDaEJXLGdCQUFnQixFQUdoQlEsWUFBYSxLQUNiRCxjQUFlLE1BcGVyQixDQXdlQ0ksT0FBUXRJLE9BQVFDIiwiZmlsZSI6ImZ1bGx2aWV3Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBmdWxsVmlldyB2MS4xLjJcclxuICovXHJcblxyXG4vKiFcclxuICogaHR0cHM6Ly9naXRodWIuY29tL3NlZXJhdGF3YW4wMS9mdWxsdmlldy5qc1xyXG4gKlxyXG4gKiBAbGljZW5zZSBHUEx2MyBmb3Igb3BlbiBzb3VyY2UgdXNlIG9ubHlcclxuICpcclxuICogQ29weXJpZ2h0IChDKSAyMDIwIGh0dHBzOi8vZ2l0aHViLmNvbS9zZWVyYXRhd2FuMDEvZnVsbHZpZXcuanMvYmxvYi9tYXN0ZXIvTElDRU5TRVxyXG4gKi9cclxuOyAoZnVuY3Rpb24gKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xyXG5cclxuICAgIHZhciBmdWxsVmlldyA9ICdmdWxsVmlldyc7XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSBwbHVnaW4gY29uc3RydWN0b3JcclxuICAgIGZ1bmN0aW9uIEZ1bGxWaWV3KHZpZXdzLCBvcHRpb25zKSB7XHJcblxyXG4gICAgICAgIHRoaXMuX2RlZmF1bHRzID0gJC5mbi5mdWxsVmlldy5kZWZhdWx0cztcclxuXHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIHRoaXMuX2RlZmF1bHRzLCBvcHRpb25zKTtcclxuICAgICAgICB0aGlzLm1haW5WaWV3ID0gJCh2aWV3cyk7XHJcbiAgICAgICAgdGhpcy52aWV3cyA9ICQodmlld3MpLmNoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX25hbWUgPSBmdWxsVmlldztcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50VmlldyA9IDA7XHJcbiAgICAgICAgdGhpcy5wcmV2aW91c1ZpZXcgPSAwO1xyXG4gICAgICAgIHRoaXMuaXNTY3JvbGxpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9mZnNldHMgPSBbXTtcclxuICAgICAgICB0aGlzLiRkb3RzRWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy4kbmF2YmFyID0gbnVsbDtcclxuICAgICAgICB0aGlzLiRhbmNob3JzID0ge307XHJcbiAgICAgICAgdGhpcy5sYXN0WSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5sYXN0WCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBBdm9pZCBGdWxsVmlldy5wcm90b3R5cGUgY29uZmxpY3RzXHJcbiAgICAkLmV4dGVuZChGdWxsVmlldy5wcm90b3R5cGUsIHtcclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24gbG9naWNcclxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkQ2FjaGUoKTtcclxuICAgICAgICAgICAgdGhpcy51dGlsaXRlcygpO1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdVcCgpO1xyXG4gICAgICAgICAgICB0aGlzLmJpbmRFdmVudHMoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyBSZW1vdmUgcGx1Z2luIGluc3RhbmNlIGNvbXBsZXRlbHlcclxuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMudW5iaW5kRXZlbnRzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuJHZpZXdzLnJlbW92ZURhdGEoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyBDYWNoZSBET00gbm9kZXMgZm9yIHBlcmZvcm1hbmNlXHJcbiAgICAgICAgYnVpbGRDYWNoZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy4kd2luZG93ID0gJCh3aW5kb3cpO1xyXG4gICAgICAgICAgICB0aGlzLiRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICB0aGlzLiRodG1sQm9keSA9ICQoXCJodG1sLCBib2R5XCIpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy4kdmlld3MgPSAkKHRoaXMudmlld3MpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5uYXZiYXIgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdGhpcy5vcHRpb25zLm5hdmJhciA9PT0gJ3N0cmluZycpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzLm9wdGlvbnMubmF2YmFyKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLiRuYXZiYXIgPSAkKHRoaXMub3B0aW9ucy5uYXZiYXIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgdXRpbGl0ZXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVEb3RzID0gZnVuY3Rpb24gY3JlYXRlRG90cygpIHtcclxuICAgICAgICAgICAgICAgIHZhciAkZG90cyA9ICQoXCIjZnYtZG90c1wiKTtcclxuICAgICAgICAgICAgICAgIGlmICgkZG90cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkZG90cy5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBkaXYgPSAkKFwiPGRpdj5cIikuYXR0cihcImlkXCIsIFwiZnYtZG90c1wiKS5hcHBlbmQoJzx1bD4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRvdHNUb29sdGlwcyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbHVnaW4gPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJHZpZXdzLmVhY2goZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2x0aXBUaXRsZSA9IHBsdWdpbi4kdmlld3MuZXEoaSkuYXR0cignZGF0YS10b29sdGlwJykgPyBwbHVnaW4uJHZpZXdzLmVxKGkpLmF0dHIoJ2RhdGEtdG9vbHRpcCcpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvb2x0aXBUaXRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmZpbmQoJ3VsJykuYXBwZW5kKCc8bGkgY2xhc3M9XCJmdi10b29sdGlwXCI+PGEgZGF0YS1zY3JvbGw9XCInICsgaSArICdcIiBocmVmPVwiI1wiIGNsYXNzPVwiXCI+PHNwYW4+PC9zcGFuPjwvYT48c3BhbiBjbGFzcz1cImZ2LXRvb2x0aXB0ZXh0XCI+JyArIHRvb2x0aXBUaXRsZSArICc8L3NwYW4+PC9saT4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2LmZpbmQoJ3VsJykuYXBwZW5kKCc8bGkgY2xhc3M9XCJmdi10b29sdGlwXCI+PGEgZGF0YS1zY3JvbGw9XCInICsgaSArICdcIiBocmVmPVwiI1wiIGNsYXNzPVwiXCI+PHNwYW4+PC9zcGFuPjwvYT48L2xpPicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kdmlld3MuZWFjaChmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXYuZmluZCgndWwnKS5hcHBlbmQoJzxsaT48YSBkYXRhLXNjcm9sbD1cIicgKyBpICsgJ1wiIGhyZWY9XCIjXCIgY2xhc3M9XCJcIj48c3Bhbj48L3NwYW4+PC9hPjwvbGk+JylcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kb3RzUG9zaXRpb24gIT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJzQlJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkaXYuZmluZCgnLmZ2LXRvb2x0aXAgLmZ2LXRvb2x0aXB0ZXh0JykuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6ICd1bnNldCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6ICcxMDUlJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRpdi5maW5kKCcuZnYtdG9vbHRpcCcpLmFkZENsYXNzKCdmdi10b29sdGlwLWxlZnQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoZGl2KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGl2LmZpbmQoJ2EnKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlQWN0aXZlU3RhdHVzID0gZnVuY3Rpb24gY2hhbmdlQWN0aXZlU3RhdHVzKCR2aWV3KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLiR2aWV3cy5yZW1vdmVDbGFzcygnYWN0aXZlJykuZXEoJHZpZXcpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZG90cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGRvdHNFbGVtZW50LnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5lcSgkdmlldykuYWRkQ2xhc3MoJ2FjdGl2ZScpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy4kYW5jaG9ycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLiRhbmNob3JzLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5maWx0ZXIoJ1tkYXRhLXNjcm9sbD1cIicgKyAkdmlldyArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUbyA9IGZ1bmN0aW9uIHNjcm9sbFRvKCR2aWV3LCBkaXIpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcGx1Z2luID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgICAgICAkdmlldyA9IHBhcnNlSW50KCR2aWV3KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vZmZzZXRzWyR2aWV3XSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiAkdmlldyA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXNWaWV3ID0gdGhpcy5jdXJyZW50VmlldyA9PT0gJHZpZXcgPyB0aGlzLnByZXZpb3VzVmlldyA6IHRoaXMuY3VycmVudFZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmlldyA9ICR2aWV3O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGlyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJldmlvdXNWaWV3ID4gdGhpcy5jdXJyZW50Vmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlyID0gXCJ1cFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2aW91c1ZpZXcgPCB0aGlzLmN1cnJlbnRWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXIgPSBcImRvd25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBFdmVudCBPblNjcm9sbFN0YXJ0XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFjayhcIm9uU2Nyb2xsU3RhcnRcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogJHZpZXcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHRoaXMucHJldmlvdXNWaWV3LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGRpclxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLiRodG1sQm9keS5zdG9wKHRydWUpLmFuaW1hdGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogdGhpcy5vZmZzZXRzWyR2aWV3XS5vZmZzZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlYXNpbmc6ICQuZWFzaW5nW3RoaXMub3B0aW9ucy5lYXNpbmddID8gdGhpcy5vcHRpb25zLmVhc2luZyA6ICdsaW5lYXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLnNwZWVkXHJcbiAgICAgICAgICAgICAgICAgICAgfSkucHJvbWlzZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uY2hhbmdlQWN0aXZlU3RhdHVzKCR2aWV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsdWdpbi5pc1Njcm9sbGluZyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmlzU2Nyb2xsaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBwbHVnaW4ub3B0aW9ucy5zcGVlZCArIDMyMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Byb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50IE9uU2Nyb2xsRW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jYWxsYmFjayhcIm9uU2Nyb2xsRW5kXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJUaGUgVmlldyBZb3UgV2FudCBUbyBTY3JvbGwgVG8gRG9lcyBub3QgRXhpc3QhXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbEJ5V2hlZWwgPSBmdW5jdGlvbiBzY3JvbGxCeVdoZWVsKGV2ZW50KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgQWxyZWFkeSBzY3JvbGxpbmdcclxuICAgICAgICAgICAgICAgIGlmICghJCgnOmFuaW1hdGVkJykubGVuZ3RoICYmICF0aGlzLmlzU2Nyb2xsaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Njcm9sbGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSA+IDAgfHwgZXZlbnQub3JpZ2luYWxFdmVudC5kZXRhaWwgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNjcm9sbCB1cFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzY3JvbGwgZG93blxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbERvd24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsRG93biA9IGZ1bmN0aW9uIHNjcm9sbERvd24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGlyID0gXCJkb3duXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50VmlldyA8IHRoaXMuJHZpZXdzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzVmlldyA9IHRoaXMuY3VycmVudFZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmlldysrO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8odGhpcy5jdXJyZW50VmlldywgZGlyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY3VycmVudFZpZXcgPT09IHRoaXMuJHZpZXdzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzU2Nyb2xsaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iYWNrVG9Ub3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Njcm9sbGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXNWaWV3ID0gdGhpcy5jdXJyZW50VmlldztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmlldyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG8odGhpcy5jdXJyZW50VmlldywgZGlyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxVcCA9IGZ1bmN0aW9uIHNjcm9sbFVwKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpciA9IFwidXBcIjtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRWaWV3ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXNWaWV3ID0gdGhpcy5jdXJyZW50VmlldztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRWaWV3LS07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUbyh0aGlzLmN1cnJlbnRWaWV3LCBkaXIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRWaWV3ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Njcm9sbGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXR0aW5nVXA6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHZoID0gdGhpcy4kd2luZG93LmhlaWdodCgpO1xyXG4gICAgICAgICAgICAvLyB2YXIgdncgPSB0aGlzLiR3aW5kb3cud2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNldHRpbmcgVmlld3BvcnRcclxuICAgICAgICAgICAgdGhpcy4kdmlld3MuY3NzKHtcclxuICAgICAgICAgICAgICAgIGhlaWdodDogdmgsXHJcbiAgICAgICAgICAgICAgICAvLyB3aWR0aDogdndcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFZpZXcgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmlzU2Nyb2xsaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDA7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5zcGVlZCAhPT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zcGVlZCA9IDUwMDtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIlNwZWVkIFNob3VsZCBiZSBvZiBUeXBlIE51bWJlclwiKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPD0gMzAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnNwZWVkID0gMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIk1pbiBTcGVlZCBpcyAzNTAgbWlsaXNlY29uZHNcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGluZyBPZmZzZXRzXHJcbiAgICAgICAgICAgIHRoaXMub2Zmc2V0cy5zcGxpY2UoMCwgdGhpcy5vZmZzZXRzLmxlbmd0aClcclxuICAgICAgICAgICAgdGhpcy4kdmlld3MuZWFjaChmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFuY2hvciA9IHRoaXMuJHZpZXdzLmVxKGkpLmF0dHIoJ2lkJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld09mZnNldCA9IHRoaXMuJHZpZXdzLmVxKGkpLm9mZnNldCgpLnRvcDtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGksXHJcbiAgICAgICAgICAgICAgICAgICAgYW5jaG9yOiBhbmNob3IsXHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiB2aWV3T2Zmc2V0XHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcblxyXG4gICAgICAgICAgICAvLyBTZXR0aW5nIE1lbnVcclxuICAgICAgICAgICAgaWYgKHRoaXMuJG5hdmJhciAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyICRtZW51ID0gdGhpcy4kbmF2YmFyO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbGV0ZWRBbmNob3IgPSB0aGlzLm9mZnNldHMuZmlsdGVyKGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmFuY2hvciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbWVudWl0ZW0gPSAkbWVudS5maW5kKCdhW2hyZWY9XCIjJyArIG9iai5hbmNob3IgKyAnXCJdJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRtZW51aXRlbS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZW51aXRlbS5hdHRyKFwiZGF0YS1zY3JvbGxcIiwgb2JqLnBvc2l0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIHNraXBcclxuICAgICAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAob2JqKSB7IHJldHVybiAoXCIjXCIgKyBvYmouYW5jaG9yKTsgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyaW5nID0gXCJhW2hyZWY9J1wiICsgc2VsZXRlZEFuY2hvci5qb2luKFwiJ10sIGFbaHJlZj0nXCIpICsgXCInXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIENvbGxlY3RpbmcgQWxsIE5hdiBJdGVtc1xyXG4gICAgICAgICAgICAgICAgdGhpcy4kYW5jaG9ycyA9IHRoaXMuJG5hdmJhci5maW5kKHF1ZXJ5U3RyaW5nKVxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ3JlYXRpbmcgRG90c1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRvdHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuJGRvdHNFbGVtZW50ID0gdGhpcy5jcmVhdGVEb3RzKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGFueSB2aWV3IGFjdGl2ZVxyXG4gICAgICAgICAgICB2YXIgJGFjdHZpZXcgPSB0aGlzLiR2aWV3cy5maWx0ZXIoJ1tjbGFzcz1cImFjdGl2ZVwiXScpO1xyXG5cclxuICAgICAgICAgICAgLy8gdGhpcy4kdmlld3MucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBpZiAoJGFjdHZpZXcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJGFjdHZpZXcuZXEoMCkub2Zmc2V0KCkudG9wO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmVEYXRhID0gdGhpcy5vZmZzZXRzLmZpbHRlcihmdW5jdGlvbiAob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5vZmZzZXQgPT09IG9mZnNldDtcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmlldyA9IGFjdGl2ZURhdGFbMF0ucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzVmlldyA9IHRoaXMuY3VycmVudFZpZXc7XHJcblxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPSBvZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID0gb2Zmc2V0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBJZiBBdXRvUGxheVxyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRvdHMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuJGRvdHNFbGVtZW50ID0gdGhpcy5jcmVhdGVEb3RzKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFNldHRpbmcgSW5pdGFpbCBBY3RpdmUgU3RhdHVzXHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlQWN0aXZlU3RhdHVzKHRoaXMuY3VycmVudFZpZXcpO1xyXG5cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyBCaW5kIGV2ZW50cyB0aGF0IHRyaWdnZXIgbWV0aG9kc1xyXG4gICAgICAgIGJpbmRFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBsdWdpbiA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICAvLyBPbiBXaW5kb3cgUmVzaXplXHJcbiAgICAgICAgICAgIHBsdWdpbi4kd2luZG93Lm9uKCdyZXNpemUnICsgJy4nICsgcGx1Z2luLl9uYW1lLCBwbHVnaW4uc2V0dGluZ1VwLmJpbmQocGx1Z2luKSk7XHJcblxyXG4gICAgICAgICAgICAvLyBPbiBEb3QgQ2xpY2tcclxuICAgICAgICAgICAgcGx1Z2luLiRkb3RzRWxlbWVudCAhPT0gbnVsbCA/XHJcbiAgICAgICAgICAgICAgICBwbHVnaW4uJGRvdHNFbGVtZW50Lm9uKCdjbGljaycgKyAnLicgKyBwbHVnaW4uX25hbWUsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghJCgnOmFuaW1hdGVkJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5wcmV2aW91c1ZpZXcgPSBwbHVnaW4uY3VycmVudFZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jdXJyZW50VmlldyA9IHBhcnNlSW50KCQodGhpcykuYXR0cihcImRhdGEtc2Nyb2xsXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNjcm9sbFRvKHBsdWdpbi5jdXJyZW50Vmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkgOiBcIlwiO1xyXG5cclxuICAgICAgICAgICAgLy8gT24gbmF2IGFuY2hvciBjbGlja1xyXG4gICAgICAgICAgICBwbHVnaW4uJGFuY2hvcnMgIT09IHVuZGVmaW5lZCAmJiBwbHVnaW4uJGFuY2hvcnMubGVuZ3RoID4gMCA/XHJcbiAgICAgICAgICAgICAgICBwbHVnaW4uJGFuY2hvcnMub24oJ2NsaWNrJyArICcuJyArIHBsdWdpbi5fbmFtZSwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghJCgnOmFuaW1hdGVkJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5wcmV2aW91c1ZpZXcgPSBwbHVnaW4uY3VycmVudFZpZXc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jdXJyZW50VmlldyA9IHBhcnNlSW50KCQodGhpcykuYXR0cihcImRhdGEtc2Nyb2xsXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNjcm9sbFRvKHBsdWdpbi5jdXJyZW50Vmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0pIDogXCJcIlxyXG5cclxuICAgICAgICAgICAgLy8gT24gTW91c2VTY3JvbGxcclxuICAgICAgICAgICAgcGx1Z2luLm9wdGlvbnMubW91c2VTY3JvbGxpbmcgP1xyXG4gICAgICAgICAgICAgICAgcGx1Z2luLiR3aW5kb3cub24oJ0RPTU1vdXNlU2Nyb2xsIG1vdXNld2hlZWwnICsgJy4nICsgcGx1Z2luLl9uYW1lLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PSAnSU5QVVQnKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNjcm9sbEJ5V2hlZWwoZSk7XHJcbiAgICAgICAgICAgICAgICB9KSA6IFwiXCJcclxuXHJcbiAgICAgICAgICAgIC8vIE9uIEtleWJvYXJkIFByZXNzXHJcbiAgICAgICAgICAgIHBsdWdpbi5vcHRpb25zLmtleWJvYXJkU2Nyb2xsaW5nID9cclxuICAgICAgICAgICAgICAgIHBsdWdpbi4kZG9jdW1lbnQub24oJ2tleWRvd24nICsgJy4nICsgcGx1Z2luLl9uYW1lLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lLnRvVXBwZXJDYXNlKCkgPT0gJ0lOUFVUJykgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBBbHJlYWR5IHNjcm9sbGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghJCgnOmFuaW1hdGVkJykubGVuZ3RoICYmICFwbHVnaW4uaXNTY3JvbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSAoZS5rZXlDb2RlID8gZS5rZXlDb2RlIDogZS53aGljaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDogLy8gRG93biBrZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2Nyb2xsRG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAzMjogLy8gU3BhY2UgQmFyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgcGx1Z2luLnNjcm9sbERvd24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6IC8vIFVwIGtleVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5zY3JvbGxVcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMzogLy8gUGFnZSB1cCBrZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2Nyb2xsVXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzQ6IC8vIFBhZ2UgZG93biBrZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uc2Nyb2xsRG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkgOiBcIlwiXHJcblxyXG4gICAgICAgICAgICAvLyBPbiBUb3VjaCBEZXZpY2VzXHJcbiAgICAgICAgICAgIHBsdWdpbi4kdmlld3Mub24oJ3RvdWNoc3RhcnQnICsgJy4nICsgcGx1Z2luLl9uYW1lLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgcGx1Z2luLmxhc3RZID0gZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WTtcclxuICAgICAgICAgICAgICAgIHBsdWdpbi5sYXN0WCA9IGUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLmNsaWVudFg7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcGx1Z2luLm9wdGlvbnMudG91Y2hTY3JvbGxpbmcgP1xyXG4gICAgICAgICAgICAgICAgcGx1Z2luLiR2aWV3cy5vbigndG91Y2hlbmQnICsgJy4nICsgcGx1Z2luLl9uYW1lLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoZS50YXJnZXQgIT09IGUuY3VycmVudFRhcmdldCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09ICdJTlBVVCcpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRZID0gZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRYID0gZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50WCA8IHBsdWdpbi5sYXN0WCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMZWZ0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwibGVmdFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFggPiBwbHVnaW4ubGFzdFgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmlnaHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJyaWdodFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBsdWdpbi5sYXN0WSA+IGN1cnJlbnRZICsgMjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNjcm9sbERvd24oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsdWdpbi5sYXN0WSA8IGN1cnJlbnRZIC0gMjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnNjcm9sbFVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkgOiBcIlwiXHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8vIFVuYmluZCBldmVudHMgdGhhdCB0cmlnZ2VyIG1ldGhvZHNcclxuICAgICAgICB1bmJpbmRFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy4kd2luZG93Lm9mZignLicgKyB0aGlzLl9uYW1lKTtcclxuICAgICAgICAgICAgdGhpcy4kZG9jdW1lbnQub2ZmKCcuJyArIHRoaXMuX25hbWUpO1xyXG4gICAgICAgICAgICB0aGlzLiR2aWV3cy5vZmYoJy4nICsgdGhpcy5fbmFtZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChldmVudE5hbWUsIGFkZHRpb25hbCkge1xyXG4gICAgICAgICAgICAvLyBDYWNoZSBvblNjcm9sbEVuZCBvcHRpb25cclxuICAgICAgICAgICAgdmFyIG9uU2Nyb2xsU3RhcnQgPSB0aGlzLm9wdGlvbnMub25TY3JvbGxTdGFydDtcclxuICAgICAgICAgICAgdmFyIG9uU2Nyb2xsRW5kID0gdGhpcy5vcHRpb25zLm9uU2Nyb2xsRW5kO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvblNjcm9sbEVuZCA9PT0gJ2Z1bmN0aW9uJyAmJiBldmVudE5hbWUgPT09IFwib25TY3JvbGxFbmRcIikge1xyXG4gICAgICAgICAgICAgICAgLy8gQ3VycmVudCwgUHJldmlvdXMsIERpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgb25TY3JvbGxFbmQodGhpcy4kdmlld3MuZXEodGhpcy5jdXJyZW50VmlldyksIHRoaXMuJHZpZXdzLmVxKHRoaXMucHJldmlvdXNWaWV3KSwgYWRkdGlvbmFsLmRpcmVjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygb25TY3JvbGxTdGFydCA9PT0gJ2Z1bmN0aW9uJyAmJiBldmVudE5hbWUgPT09IFwib25TY3JvbGxTdGFydFwiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDdXJyZW50LCBEZXN0aW5hdGlvbiwgRGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBvblNjcm9sbFN0YXJ0KHRoaXMuJHZpZXdzLmVxKGFkZHRpb25hbC5jdXJyZW50KSwgdGhpcy4kdmlld3MuZXEoYWRkdGlvbmFsLmRlc3RpbmF0aW9uKSwgYWRkdGlvbmFsLmRpcmVjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgICQuZm4uZnVsbFZpZXcgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG5cclxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdW5kZWZpbmVkIHx8IHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0Jykge1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCEkLmRhdGEodGhpcywgZnVsbFZpZXcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5kYXRhKHRoaXMsIGZ1bGxWaWV3LCBuZXcgRnVsbFZpZXcodGhpcywgb3B0aW9ucykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuXHJcbiAgICAkLmZuLmZ1bGxWaWV3LmRlZmF1bHRzID0ge1xyXG4gICAgICAgIC8vTmF2aWdhdGlvblxyXG4gICAgICAgIG5hdmJhcjogdW5kZWZpbmVkLFxyXG4gICAgICAgIGRvdHM6IHRydWUsXHJcbiAgICAgICAgZG90c1Bvc2l0aW9uOiAncmlnaHQnLFxyXG4gICAgICAgIGRvdHNUb29sdGlwczogZmFsc2UsXHJcblxyXG4gICAgICAgIC8vU2Nyb2xsaW5nXHJcbiAgICAgICAgZWFzaW5nOiAnbGluZWFyJyxcclxuICAgICAgICBiYWNrVG9Ub3A6IGZhbHNlLFxyXG4gICAgICAgIHNwZWVkOiA1MDAsIC8vbXNcclxuXHJcbiAgICAgICAgLy8gQWNjZXNzaWJpbGl0eVxyXG4gICAgICAgIGtleWJvYXJkU2Nyb2xsaW5nOiB0cnVlLFxyXG4gICAgICAgIG1vdXNlU2Nyb2xsaW5nOiB0cnVlLFxyXG4gICAgICAgIHRvdWNoU2Nyb2xsaW5nOiB0cnVlLFxyXG5cclxuICAgICAgICAvLyBDYWxsYmFja1xyXG4gICAgICAgIG9uU2Nyb2xsRW5kOiBudWxsLFxyXG4gICAgICAgIG9uU2Nyb2xsU3RhcnQ6IG51bGwsXHJcblxyXG4gICAgfTtcclxuXHJcbn0pKGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7Il19
